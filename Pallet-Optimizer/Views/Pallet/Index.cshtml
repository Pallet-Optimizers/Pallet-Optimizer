@model Pallet_Optimizer.Models.PalletHolder
@{
    Layout = null; // adjust to your layout if present
    var currentIndex = Model?.CurrentPalletIndex ?? 0;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Pallet Visualizer</title>

    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>

    <link rel="stylesheet" href="~/css/site.css" />
    <style>
        body, html { height: 100%; margin: 0; display: flex; }
        .sidebar { width: 320px; background: #0f1720; color: #e6eef6; padding: 16px; box-sizing: border-box; }
        .content { flex: 1; position: relative; }
        #renderCanvas { width: 100%; height: 100%; display:block; }
        .control-row { margin-bottom: 12px; }
        label { display:block; margin-bottom:4px; color:#cbd5e1; }
        select, input[type=range] { width: 100%; }
    </style>
</head>
<body>
    <div class="sidebar">
        <h2>Pallet Controls</h2>

        <div class="control-row">
            <label>Pallet</label>
            <select id="palletSelect">
                @for (int i = 0; i < (Model?.Pallets?.Count ?? 0); i++)
                {
                    var p = Model.Pallets[i];
                    <option value="@i" selected="@(i == currentIndex)">@p.Name (@i)</option>
                }
            </select>
        </div>

        <div class="control-row">
            <label>Material Type</label>
            <select id="materialSelect">
                @foreach (var val in Enum.GetValues(typeof(Pallet_Optimizer.Models.PALLET_MATERIAL_TYPE)))
                {
                    <option value="@val">@val</option>
                }
            </select>
        </div>

        <div class="control-row">
            <label>Scale</label>
            <input type="range" id="scaleRange" min="10" max="200" value="100" />
        </div>

        <div class="control-row">
            <button id="saveBtn">Save (AJAX)</button>
        </div>
    </div>

    <div class="content">
        <canvas id="renderCanvas"></canvas>
    </div>

    <script>
        // initial data from server
        window.__PalletHolder = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model));
        window.__initialIndex = @currentIndex;
    </script>

    <script src="~/js/pallet.js"></script>
</body>
</html>
